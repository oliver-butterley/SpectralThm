\chapter{Orthogonal projections}

(The contents of this section should be added to Mathlib.Analysis.InnerProductSpace.Projection)

Let $H$ be a complex Hilbert space and $K$ be a closed subspace of $H$.
We denote $K^\perp$ the orthogonal complement of $K$ in $H$.
Any vector $x \in H$ can be written as $x = x_K + x_{K^\perp}$, where $x_K \in K, x_{K^\perp} \in K^\perp$.
The map $p(K) : x \to x_K$ is called the orthogonal projection to $K$.
\begin{lemma}
 It holds that $p(K) = p(K)^2 = p(K)^*$.
\end{lemma}
\begin{proof}
 The first equality follows by the uniqueness of the orthogonal decomposition.

 The second equality follows because $\langle y, p(K)x \rangle = \langle y, x_K\rangle = \langle y_K, x \rangle = \langle p(K)y, x\rangle$
 by orthogonality.
\end{proof}

\begin{lemma}
 For $p \in \mathcal{B}(H)$ such that $p = p^2 = p^*$,
 there is a closed subspace $K$ such that $p = p(K)$.
\end{lemma}
\begin{proof}
 By $p = p^2$, it is a projection. Let $K$ be the image of $p$.
 Note that $x = (p + (1-p))x = px + (1-p)x$ for any $x \in H$
 and $\langle px, (1-p)x\rangle = \langle x, (p-p)x\rangle = 0$.
 So this gives the orthogonal decomposition.
\end{proof}

\begin{lemma}[12.6, part 1]
 Let $\{x_n\}$ be a sequence of pairwise orthogonal vectors in $H$.
 Then the following are equivalent.
 \begin{itemize}
  \item $\sum_{n=1}^\infty x_n$ converges in the norm topology of $H$.
  \item $\sum_{n=1}^\infty \|x_n\|^2 < \infty$.
 \end{itemize}
\end{lemma}
\begin{proof}
 Note that, by orthogonality,
 $\|\sum_{j=m}^n x_j\|^2 = \sum_{j=m}^n \|x_j\|^2$.
 Therefore, the second condition implies that the sequence $\sum_{j=1}^n x_j$ is Cauchy.

 Conversely, as $\sum_{j=1}^n x_j$ converges in norm, the square of its norm $\sum_{j=1}^n \|x_j\|^2$ converges.

\end{proof}

\begin{lemma}[12.6, part 2]
 Let $\{x_n\}$ be a sequence of pairwise orthogonal vectors in $H$.
 Then the following are equivalent.
 \begin{itemize}
  \item $\sum_{n=1}^\infty x_n$ converges in the norm topology of $H$.
  \item $\sum_{n=1}^\infty \langle x, y\rangle$ converges for all $y \in H$.
 \end{itemize}
\end{lemma}
\begin{proof}
 The first condition implies the second by Cauchy-Schwartz.

 Assume that
 $\sum_{n=1}^\infty \langle x, y\rangle$ converges for all $y \in H$.
 Define $\Lambda_n y = \sum_{j=1}^n \langle y, x_j\rangle$.
 As this converges for each $y$, by Banach-Steinhaus, $\{\|\Lambda_n\|\}$ is bounded.
 As $\|\Lambda_n\| = \sqrt{\sum_{j=1}^n \|x_j\|}$, this gives the first condition.
\end{proof}
